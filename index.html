<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Helper for Jackie</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            margin: 0; 
            font-family: system-ui, -apple-system, sans-serif; 
        }
        .gradient-bg { 
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); 
        }
        .chat-scroll { 
            max-height: 50vh; 
            overflow-y: auto; 
        }
        .tab-button.active {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, createElement: e } = React;

        function NFLHelperForJackie() {
            const [activeTab, setActiveTab] = useState('chat');
            const [messages, setMessages] = useState([
                {
                    type: 'assistant',
                    content: "Hi Jackie! 👋 I'm your NFL helper! Ask me about current players, teams, rules, or anything football-related!"
                }
            ]);
            const [inputValue, setInputValue] = useState('');
            const [isLoading, setIsLoading] = useState(false);

            const teamMap = {
                'steelers': '23', 'chiefs': '12', 'cowboys': '6', 'raiders': '13',
                'jets': '20', 'bills': '2', 'patriots': '17', 'dolphins': '15',
                'ravens': '33', 'bengals': '4', 'browns': '5', 'titans': '10',
                'colts': '11', 'jaguars': '30', 'texans': '34', 'broncos': '7',
                'chargers': '24', 'packers': '9', 'bears': '3', 'lions': '8',
                'vikings': '16', 'giants': '19', 'eagles': '21', 'commanders': '28',
                'cardinals': '22', 'rams': '14', 'seahawks': '26', '49ers': '25',
                'saints': '18', 'falcons': '1', 'panthers': '29', 'bucs': '27'
            };

            const getTeamInfo = (question) => {
                const lower = question.toLowerCase();
                for (const [name, id] of Object.entries(teamMap)) {
                    if (lower.includes(name)) {
                        return { name, id };
                    }
                }
                return null;
            };

            const fetchRosterInfo = async (question) => {
                const team = getTeamInfo(question);
                if (!team) return "I couldn't identify which team you're asking about. Try asking about a specific team like 'Chiefs' or 'Cowboys'.";

                try {
                    const url = `https://site.api.espn.com/apis/site/v2/sports/football/nfl/teams/${team.id}/roster`;
                    const response = await fetch(url);
                    const data = await response.json();

                    if (!data.athletes || data.athletes.length === 0) {
                        return `I found the team but no roster data is available right now. Try checking ESPN.com directly.`;
                    }

                    const lower = question.toLowerCase();
                    let targetPos = '';
                    let posName = '';

                    if (lower.includes('quarterback') || lower.includes('qb')) {
                        targetPos = 'QB';
                        posName = 'quarterback';
                    } else if (lower.includes('running back') || lower.includes('rb')) {
                        targetPos = 'RB';
                        posName = 'running back';
                    } else if (lower.includes('wide receiver') || lower.includes('wr')) {
                        targetPos = 'WR';
                        posName = 'wide receiver';
                    }

                    const matchingPlayers = data.athletes.filter(player => {
                        if (!player.position) return false;
                        const pos = player.position.abbreviation || player.position.name || '';
                        return pos.toUpperCase().includes(targetPos);
                    });

                    if (matchingPlayers.length > 0) {
                        const teamName = data.team.displayName || team.name;
                        
                        if (targetPos === 'QB') {
                            const qb = matchingPlayers[0];
                            const name = qb.displayName || qb.fullName || qb.name || 'Unknown Player';
                            const jersey = qb.jersey || 'Unknown';
                            return `${name} is the quarterback for the ${teamName}. He wears #${jersey}.`;
                        } else {
                            const players = matchingPlayers.slice(0, 3).map(p => {
                                const name = p.displayName || p.fullName || p.name || 'Unknown';
                                const jersey = p.jersey || '?';
                                return `${name} (#${jersey})`;
                            });
                            return `The ${teamName} ${posName}s include: ${players.join(', ')}.`;
                        }
                    } else {
                        return `I found the ${data.team.displayName} roster but no ${posName}s listed. The roster might be updating. Try ESPN.com for the most current information.`;
                    }

                } catch (error) {
                    return `I'm having trouble accessing roster information right now. You can check current rosters at ESPN.com or NFL.com.`;
                }
            };

            const basicAnswers = {
                'touchdown': "A touchdown is worth 6 points and happens when a team gets the ball into the opponent's end zone.",
                'field goal': "A field goal is worth 3 points when the team kicks the ball through the yellow goalposts.",
                'first down': "A first down means a team gets 4 new attempts to advance the ball 10 yards.",
                'quarters': "A football game has 4 quarters, each 15 minutes long (60 minutes total game time).",
                'players': "Each team has 11 players on the field at any time.",
                'quarterback': "The quarterback (QB) leads the offense, throws passes, and makes play decisions."
            };

            const handleQuestion = async (question) => {
                const lower = question.toLowerCase();
                
                // Check if asking about current players/rosters
                if ((lower.includes('who is') || lower.includes('who are')) && 
                    (lower.includes('quarterback') || lower.includes('qb') || 
                     lower.includes('running back') || lower.includes('rb') ||
                     lower.includes('wide receiver') || lower.includes('wr'))) {
                    return await fetchRosterInfo(question);
                }

                // Check basic knowledge
                for (const [key, answer] of Object.entries(basicAnswers)) {
                    if (lower.includes(key)) {
                        return answer;
                    }
                }

                // Pattern matching
                if (lower.includes('long') && lower.includes('game')) return basicAnswers.quarters;
                if (lower.includes('worth') && lower.includes('touchdown')) return basicAnswers.touchdown;
                if (lower.includes('how many') && lower.includes('player')) return basicAnswers.players;

                return "Great question, Jackie! I can help with NFL rules, current player information, and team rosters. Try asking about specific players or check out the Rules section!";
            };

            const submitQuestion = async (question) => {
                if (!question.trim() || isLoading) return;
                
                setMessages(prev => [...prev, { type: 'user', content: question }]);
                setIsLoading(true);
                
                try {
                    const answer = await handleQuestion(question);
                    setMessages(prev => [...prev, { type: 'assistant', content: answer }]);
                } catch (error) {
                    setMessages(prev => [...prev, { 
                        type: 'assistant', 
                        content: "I'm having trouble right now, but I'm here to help with your football questions!" 
                    }]);
                }
                
                setIsLoading(false);
                setInputValue('');
            };

            const quickQuestions = [
                "Who is the quarterback for the Chiefs?",
                "What does first down mean?",
                "How long is a football game?",
                "Who are the running backs for the Cowboys?",
                "What's a touchdown worth?",
                "How many players are on the field?"
            ];

            const rulesData = [
                {
                    title: "Basic Scoring",
                    content: "• Touchdown: 6 points\n• Extra Point: 1 point\n• Field Goal: 3 points\n• Safety: 2 points"
                },
                {
                    title: "Game Structure",
                    content: "• 4 quarters, 15 minutes each\n• 12-minute halftime\n• 3 timeouts per team per half"
                },
                {
                    title: "Downs System",
                    content: "• Teams get 4 downs to advance 10 yards\n• Success = new set of 4 downs\n• Can punt on 4th down"
                }
            ];

            const resources = [
                { title: "NFL.com", url: "https://www.nfl.com", desc: "Official NFL website" },
                { title: "ESPN NFL", url: "https://www.espn.com/nfl/", desc: "News and stats" }
            ];

            // Render functions
            const renderChat = () => e('div', null,
                e('div', { className: 'p-6 bg-white' },
                    e('h2', { className: 'text-lg font-bold mb-4' }, 'Ask me anything about football:'),
                    e('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-3' },
                        ...quickQuestions.map((q, i) => 
                            e('button', {
                                key: i,
                                onClick: () => submitQuestion(q),
                                className: 'p-3 bg-blue-50 hover:bg-blue-100 rounded-lg text-left text-sm border border-blue-200'
                            }, q)
                        )
                    )
                ),
                e('div', { className: 'p-6' },
                    e('div', { className: 'chat-scroll space-y-4 mb-6 bg-gray-50 rounded-lg p-4' },
                        ...messages.map((msg, i) => 
                            e('div', { 
                                key: i, 
                                className: `flex ${msg.type === 'user' ? 'justify-end' : 'justify-start'}` 
                            },
                                e('div', { 
                                    className: `max-w-md p-4 rounded-lg ${
                                        msg.type === 'user' 
                                            ? 'bg-blue-600 text-white' 
                                            : 'bg-white border'
                                    }` 
                                },
                                    msg.type === 'assistant' && e('div', { className: 'text-xs text-blue-600 mb-1' }, 'NFL Helper'),
                                    e('p', null, msg.content)
                                )
                            )
                        )
                    ),
                    e('div', { className: 'bg-white rounded-lg border p-4' },
                        e('div', { className: 'flex gap-3' },
                            e('input', {
                                type: 'text',
                                value: inputValue,
                                onChange: (ev) => setInputValue(ev.target.value),
                                onKeyPress: (ev) => ev.key === 'Enter' && submitQuestion(inputValue),
                                placeholder: 'Ask about players, rules, teams...',
                                disabled: isLoading,
                                className: 'flex-1 p-3 border rounded focus:outline-none focus:border-blue-500'
                            }),
                            e('button', {
                                onClick: () => submitQuestion(inputValue),
                                disabled: isLoading || !inputValue.trim(),
                                className: 'px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50'
                            }, isLoading ? 'Thinking...' : 'Ask')
                        )
                    )
                )
            );

            const renderRules = () => e('div', { className: 'p-6' },
                e('h2', { className: 'text-2xl font-bold mb-6' }, 'NFL Rules & Basics'),
                e('div', { className: 'space-y-6' },
                    ...rulesData.map((rule, i) => 
                        e('div', { key: i, className: 'bg-white rounded-lg border p-6' },
                            e('h3', { className: 'text-xl font-semibold text-blue-600 mb-3' }, rule.title),
                            e('div', { className: 'whitespace-pre-line' }, rule.content)
                        )
                    )
                )
            );

            const renderResources = () => e('div', { className: 'p-6' },
                e('h2', { className: 'text-2xl font-bold mb-6' }, 'Helpful Resources'),
                e('div', { className: 'grid gap-4' },
                    ...resources.map((res, i) => 
                        e('div', { key: i, className: 'bg-white rounded-lg border p-6' },
                            e('h3', { className: 'text-xl font-semibold text-blue-600 mb-2' }, res.title),
                            e('p', { className: 'mb-4' }, res.desc),
                            e('a', { 
                                href: res.url, 
                                target: '_blank',
                                className: 'px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700'
                            }, 'Visit Site')
                        )
                    )
                )
            );

            return e('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 to-purple-50' },
                e('div', { className: 'gradient-bg text-white p-6 text-center' },
                    e('div', { className: 'flex items-center justify-center gap-3 mb-3' },
                        e('div', { 
                            className: 'w-8 h-8 bg-white rounded-full flex items-center justify-center text-blue-600 font-bold' 
                        }, '🏈'),
                        e('h1', { className: 'text-3xl font-bold' }, 'NFL Helper for Jackie'),
                        e('div', { className: 'text-2xl' }, '❤️')
                    ),
                    e('p', { className: 'text-lg opacity-90' }, 'Your complete guide to understanding football!')
                ),

                e('div', { className: 'bg-white border-b' },
                    e('div', { className: 'flex justify-center gap-1 p-4' },
                        ['chat', 'rules', 'resources'].map(tab => 
                            e('button', {
                                key: tab,
                                onClick: () => setActiveTab(tab),
                                className: `tab-button px-6 py-3 rounded-lg font-medium ${
                                    activeTab === tab ? 'active' : 'bg-gray-100 hover:bg-gray-200'
                                }`
                            }, tab === 'chat' ? '💬 Ask Questions' : 
                               tab === 'rules' ? '📖 Rules Guide' : '🔗 Resources')
                        )
                    )
                ),

                activeTab === 'chat' ? renderChat() : 
                activeTab === 'rules' ? renderRules() : renderResources(),

                e('div', { className: 'p-6 text-center text-gray-500' },
                    'V18 Made with ❤️ to help Jackie enjoy football with the family'
                )
            );
        }

        ReactDOM.render(React.createElement(NFLHelperForJackie), document.getElementById('root'));
    </script>
</body>
</html>
